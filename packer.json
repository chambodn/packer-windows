{
    "variables": {
        "project_id": "sandbox-249706",
        "account_file": "{{env `GKE_ACCOUNT`}}",
        "packer_user": "packer",
        "zone": "europe-west1-b"
    },
    "builders": [
        {
            "type": "googlecompute",
            "account_file": "{{user `account_file`}}",
            "project_id": "{{user `project_id`}}",
            "image_name": "packer-test",
            "source_image": "windows-server-2016-dc-v20191210",
            "disk_size": "50",
            "disk_type": "pd-ssd",
            "machine_type": "n1-standard-4",
            "image_description": "created-with-packer",
            "use_internal_ip": false,
            "communicator": "winrm",
            "winrm_username": "{{user `packer_user`}}",
            "winrm_insecure": true,
            "winrm_use_ssl": true,
            "metadata": {
                "sysprep-specialize-script-cmd": "winrm quickconfig -quiet & net user /add {{user `packer_user`}} & net localgroup administrators {{user `packer_user`}} /add & winrm set winrm/config/service/auth @{Basic=\"true\"}"
            },
            "zone": "{{ user `zone` }}"
        }
    ],  
    "provisioners": [
    {
      "type":  "powershell",
      "scripts": [
        "scripts/02_win-updates.ps1",
        "scripts/03_openssh.ps1"
        ],
      "elevated_user": "SYSTEM",
      "elevated_password": ""
    }
  ]
}
